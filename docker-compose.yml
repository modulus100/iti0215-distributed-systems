version: '3.8'

services:
  user-api:
    build: user-microservice
    volumes:
      - ./user-microservice:/opt/jboss/wildfly/standalone/deployments
    ports:
      - 8080:8080
      - 8787:8787
    command: /opt/jboss/wildfly/bin/standalone.sh -b 0.0.0.0 -bmanagement 0.0.0.0 --debug *:8787
    depends_on:
      - pgdb

  inventory-api:
    build: inventory-microservice
    volumes:
      - ./inventory-microservice:/opt/jboss/wildfly/standalone/deployments
    ports:
      - 8081:8080
      - 8788:8787
    command: /opt/jboss/wildfly/bin/standalone.sh -b 0.0.0.0 -bmanagement 0.0.0.0 --debug *:8787
    depends_on:
      - pgdb

  pgdb:
    image: postgres
    container_name: pgdb
    environment:
      - POSTGRES_DB=postgres
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
    volumes:
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - 5432:5432

#  client:
#    build: client
#    volumes:
#      - ./client:/usr/src/client
#    ports:
#     - "4000:4000"
#    depends_on:
#      - user-api
#      - inventory-api

